---
layout: post
title: 微服务设计技巧
description: 
date: 2017-06-25
---

# 四个技巧

1. 认真设计领域模型及模型间的关系
2. 接口的输入输出只能为基本类型或领域模型
3. 不要依赖其他领域的模型
4. 计算能力封装成SDK

# 四个技巧的推导过程

微服务设计时，有一个重要的非功能需求需要满足：具有极强的可复用性，部门内外都可复用。

## 认真设计领域模型及模型间的关系，为什么领域模型如此重要？

1. 我们所开发的软件基本上都是信息管理系统。
2. 在将需求转化成软件的过程中，首先要作的事情是分析出业务实体及关系，并用类来表示，这些类我们称之为领域模型。
3. 在设计领域模型时，我们会受到画面展现的干扰，会为其添加一些方便画面展现的属性。我们也会受到持久化的干扰，会为其添加一些方便持久化的属性。这种作法会使领域模型失去可复用性，从而直接导致微服务的接口不可复用，稳定性差。
4. 领域模型间的关系，通常我们是通过关联另一模型的id来表示。采用这种作法会有一个问题，服务接口无法同时输入或输出多个相关模型的数据。

## 接口的输入输出只能为基本类型或领域模型，为什么要这样规定？

1. 认真设计好的领域模型及关系，为这一技巧提供了可行性。
2. 之所以要采用这条约束，是为了让微服务的接口的可复用性成为必然，更加稳定。

## 不要依赖其他领域的模型，为什么？

1. 如果某一领域的模型依赖其他领域的模型，那这样设计出来的微服务的可复用就会减弱，因为所有相互依赖的领域需要一起被复用。
2. 让每一个微服务都能高度自治，对外的依赖通过代理模式来解决。应用通过组合各种微服务提供的能力功能就会变得非常强大。

## 计算能力封装成SDK，什么意思？

1. 什么是业务能力？对领域模型的CRUD、状态管理、关系维护可以认为是业务能力。
2. 什么是计算能力？跟领域模型没有关系，比如文本处理、图像识别、协议转换等。
3. 单纯的计算能力以SDK的方式进行复用，很方便，没有必要微服务化。
4. 微服务对外提供的业务能力中包含了计算能力，这也是合理的。






